[
  {
    "tenant_id": 1,
    "name": "Create ServiceNow Incident",
    "vendor": "ServiceNow",
    "integration_name": "ServiceNow",
    "method": "POST",
    "path_template": "/api/now/table/incident",
    "body_template": "{\n    \"caller_id\": \"AuthMind Service\",\n    \"short_description\": \"AuthMind [{{.IssueType | jsonescape}}]: {{.Title | default \"Security Issue Detected\" | jsonescape}}\",\n    \"description\": \"AuthMind Summary: {{.Details.Summary | jsonescape}}\\n\\nIssue Details:\\n{{range .Details.Results}}--- \\nMessage: {{.Message | jsonescape}}\\nRisk: {{.Risk | jsonescape}}\\nIncidents: {{.Incidents | marshal | jsonescape}}\\n{{end}}\\n\\n{{if .RemediationSteps}}Remediation Steps:\\n{{.RemediationSteps | jsonescape}}\\n\\n{{end}}{{if .RemediationURL}}Documentation: {{.RemediationURL | jsonescape}}\\n\\n{{end}}Footer: {{.Footer | jsonescape}}\",\n    \"impact\": \"{{if eq .Severity 1}}1{{else if eq .Severity 2}}1{{else if eq .Severity 3}}2{{else}}3{{end}}\",\n    \"urgency\": \"{{if eq .Severity 1}}1{{else if eq .Severity 2}}2{{else if eq .Severity 3}}2{{else}}3{{end}}\",\n    \"priority\": \"{{if eq .Severity 1}}1{{else if eq .Severity 2}}2{{else if eq .Severity 3}}3{{else}}5{{end}}\",\n    \"work_notes\": \"AuthMind Issue ID: {{.IssueID | jsonescape}}\\nInitial Risk Score: {{.Risk | jsonescape}}\\nFirst Seen: {{.FirstSeen | jsonescape}}\\nEvent Timestamp: {{.Timestamp | jsonescape}}\\nIssue Keys: {{.IssueKeys | marshal | jsonescape}}\",\n    \"contact_type\": \"automated\",\n    \"category\": \"Security\"\n}"
  },
  {
    "tenant_id": 1,
    "name": "Notify Security Slack",
    "vendor": "Slack",
    "integration_name": "Slack",
    "method": "POST",
    "path_template": "/services/T00/B00/XXX",
    "body_template": "{\n    \"blocks\": [\n        {\n            \"type\": \"header\",\n            \"text\": {\n                \"type\": \"plain_text\",\n                \"text\": \" Security Issue: {{.IssueType | jsonescape}}\",\n                \"emoji\": true\n            }\n        },\n        {\n            \"type\": \"section\",\n            \"text\": {\n                \"type\": \"mrkdwn\",\n                \"text\": \"*Description:*\\n{{.IssueMessage | jsonescape}}\"\n            }\n        },\n        {\n            \"type\": \"section\",\n            \"fields\": [\n                {\n                    \"type\": \"mrkdwn\",\n                    \"text\": \"*Risk Level:*\\n{{.Risk | jsonescape}}\"\n                },\n                {\n                    \"type\": \"mrkdwn\",\n                    \"text\": \"*Domain:*\\n{{index .IssueKeys \"domain\" | default \"N/A\" | jsonescape}}\"\n                },\n                {\n                    \"type\": \"mrkdwn\",\n                    \"text\": \"*Total Flows:*\\n{{.FlowCount}}\"\n                },\n                {\n                    \"type\": \"mrkdwn\",\n                    \"text\": \"*Incidents:*\\n{{.IncidentCount}}\"\n                }\n            ]\n        },\n        {\n            \"type\": \"divider\"\n        },\n        {\n            \"type\": \"section\",\n            \"text\": {\n                \"type\": \"mrkdwn\",\n                \"text\": \"*Primary Incident Details*\"\n            }\n        },\n        {\n            \"type\": \"section\",\n            \"fields\": [\n                {\n                    \"type\": \"mrkdwn\",\n                    \"text\": \"*Identity:*\\n {{.UserEmail | jsonescape}}\"\n                },\n                {\n                    \"type\": \"mrkdwn\",\n                    \"text\": \"*Asset:*\\n {{index .IssueKeys \"asset_name\" | default \"N/A\" | jsonescape}}\"\n                }\n            ]\n        },\n        {{if .RemediationSteps}}\n        {\n            \"type\": \"divider\"\n        },\n        {\n            \"type\": \"section\",\n            \"text\": {\n                \"type\": \"mrkdwn\",\n                \"text\": \"*Remediation Recommendation*\"\n            }\n        },\n        {\n            \"type\": \"section\",\n            \"text\": {\n                \"type\": \"mrkdwn\",\n                \"text\": \"{{.RemediationSteps | jsonescape}}\"\n            }\n        },\n        {{end}}\n        {{if .RemediationURL}}\n        {\n            \"type\": \"context\",\n            \"elements\": [\n                {\n                    \"type\": \"mrkdwn\",\n                    \"text\": \"<\u0010|{{.RemediationURL | jsonescape}}> *Full Documentation*\"\n                }\n            ]\n        },\n        {{end}}\n        {\n            \"type\": \"divider\"\n        }\n    ]\n}"
  },
  {
    "tenant_id": 1,
    "name": "Notify Security Teams",
    "vendor": "Microsoft",
    "integration_name": "Microsoft Teams",
    "method": "POST",
    "path_template": "/webhook/XXX",
    "body_template": "{\"type\":\"message\",\"attachments\":[{\"contentType\":\"application/vnd.microsoft.card.adaptive\",\"content\":{\"type\":\"AdaptiveCard\",\"body\":[{\"type\":\"TextBlock\",\"text\":\"{{.Title}}\"}]}} \" ] }"
  },
  {
    "tenant_id": 1,
    "name": "Disable AD User",
    "vendor": "Microsoft",
    "integration_name": "On-Prem AD",
    "method": "POWERSHELL",
    "path_template": "",
    "body_template": "Import-Module ActiveDirectory; Disable-ADAccount -Identity '{{.UserEmail}}'"
  },
  {
    "tenant_id": 1,
    "name": "Force AD Password Change",
    "vendor": "Microsoft",
    "integration_name": "On-Prem AD",
    "method": "POWERSHELL",
    "path_template": "",
    "body_template": "Import-Module ActiveDirectory; Set-ADUser -Identity '{{.UserEmail}}' -ChangePasswordAtLogon "
  },
  {
    "tenant_id": 1,
    "name": "Suspend Okta User",
    "vendor": "Okta",
    "integration_name": "Okta",
    "method": "POST",
    "path_template": "/api/v1/users/{{.UserEmail}}/lifecycle/suspend",
    "body_template": "{}"
  },
  {
    "tenant_id": 1,
    "name": "Revoke Okta Sessions",
    "vendor": "Okta",
    "integration_name": "Okta",
    "method": "DELETE",
    "path_template": "/api/v1/users/{{.UserEmail}}/sessions",
    "body_template": "{}"
  },
  {
    "tenant_id": 1,
    "name": "Send Torq Event",
    "vendor": "Torq",
    "integration_name": "Torq",
    "method": "POST",
    "path_template": "/v1/webhooks/XXX",
    "body_template": "{\"event_source\":\"AuthMind\",\"affected_entities\":[\"{{.UserEmail}}\"]}"
  },
  {
    "tenant_id": 1,
    "name": "Ingest SecOps Event",
    "vendor": "Google",
    "integration_name": "Google SecOps",
    "method": "POST",
    "path_template": "/v1/ingestwebhooks/XXX",
    "body_template": "{\"principal\":{\"user\":{\"userid\":\"{{.UserEmail}}\"}} }"
  },
  {
    "tenant_id": 1,
    "name": "SailPoint: Disable Account",
    "vendor": "SailPoint",
    "integration_name": "SailPoint IdentityNow",
    "method": "POST",
    "path_template": "/v3/accounts/{{index .IssueKeys \"account_id\" | default \"REPLACE_ME\"}}/disable",
    "body_template": "{}"
  },
  {
    "tenant_id": 1,
    "name": "SailPoint: Revoke Entitlement",
    "vendor": "SailPoint",
    "integration_name": "SailPoint IdentityNow",
    "method": "POST",
    "path_template": "/v3/access-requests",
    "body_template": "{\n  \"requestedFor\": [\"{{.UserEmail}}\"],\n  \"requestType\": \"REVOKE_ACCESS\",\n  \"requestedItems\": [\n    {\n      \"id\": \"{{index .IssueKeys \"entitlement_id\" | default \"REPLACE_ME\"}}\",\n      \"type\": \"ENTITLEMENT\"\n    }\n  ],\n  \"comment\": \"Automatic revocation triggered by AuthMind remediation engine.\"\n}"
  },
  {
    "tenant_id": 1,
    "name": "SailPoint: Trigger Recertification",
    "vendor": "SailPoint",
    "integration_name": "SailPoint IdentityNow",
    "method": "POST",
    "path_template": "/v3/certification-campaigns",
    "body_template": "{\n  \"name\": \"AuthMind Remediation: {{.IssueType}} - {{.UserEmail}}\",\n  \"description\": \"Targeted recertification for issue {{.IssueID}}\",\n  \"type\": \"IDENTITY\",\n  \"filter\": {\n    \"type\": \"IDENTITY\",\n    \"id\": \"{{.UserEmail}}\"\n  }\n}"
  },
  {
    "tenant_id": 1,
    "name": "Saviynt: Disable User",
    "vendor": "Saviynt",
    "integration_name": "Saviynt IGA",
    "method": "POST",
    "path_template": "/updateUser",
    "body_template": "{\n  \"username\": \"{{.UserEmail}}\",\n  \"statuskey\": \"0\",\n  \"enabled\": \"false\"\n}"
  },
  {
    "tenant_id": 1,
    "name": "Saviynt: Remove Entitlement",
    "vendor": "Saviynt",
    "integration_name": "Saviynt IGA",
    "method": "POST",
    "path_template": "/removeEntitlementFromUser",
    "body_template": "{\n  \"username\": \"{{.UserEmail}}\",\n  \"entitlementName\": \"{{index .IssueKeys \"entitlement\" | default \"REPLACE_ME\"}}\"\n}"
  },
  {
    "tenant_id": 1,
    "name": "Saviynt: Trigger Recertification",
    "vendor": "Saviynt",
    "integration_name": "Saviynt IGA",
    "method": "POST",
    "path_template": "/createCertificationCampaign",
    "body_template": "{\n  \"campaignname\": \"AuthMind Remediation - {{.IssueID}}\",\n  \"type\": \"User\",\n  \"userlist\": \"{{.UserEmail}}\"\n}"
  },
  {
    "tenant_id": 1,
    "name": "SSF: RISC Account Compromised",
    "vendor": "Generic",
    "integration_name": "Generic SSF Receiver",
    "method": "POST",
    "path_template": "",
    "body_template": "{\n  \"subject\": {\n    \"format\": \"email\",\n    \"email\": \"{{.UserEmail}}\"\n  },\n  \"events\": {\n    \"https://schemas.openid.net/secevent/risc/event-type/account-compromised\": {\n      \"risk_score\": \"{{.Risk}}\",\n      \"reason\": \"{{.Title | jsonescape}}\"\n    }\n  }\n}"
  },
  {
    "tenant_id": 1,
    "name": "SSF: CAEP Session Revoked",
    "vendor": "Generic",
    "integration_name": "Generic SSF Receiver",
    "method": "POST",
    "path_template": "",
    "body_template": "{\n  \"subject\": {\n    \"format\": \"email\",\n    \"email\": \"{{.UserEmail}}\"\n  },\n  \"events\": {\n    \"https://schemas.openid.net/secevent/caep/event-type/session-revoked\": {\n      \"initiated_by\": \"policy\",\n      \"reason_admin\": \"AuthMind Remediation: {{.IssueID}}\"\n    }\n  }\n}"
  },
  {
    "tenant_id": 1,
    "name": "SSF: CAEP Credential Change",
    "vendor": "Generic",
    "integration_name": "Generic SSF Receiver",
    "method": "POST",
    "path_template": "",
    "body_template": "{\n  \"subject\": {\n    \"format\": \"email\",\n    \"email\": \"{{.UserEmail}}\"\n  },\n  \"events\": {\n    \"https://schemas.openid.net/secevent/caep/event-type/credential-change-required\": {\n      \"change_type\": \"password\",\n      \"reason_admin\": \"Compromise Detected\"\n    }\n  }\n}"
  }
]